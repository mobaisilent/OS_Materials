## 参考源码

```shell
https://blog.csdn.net/hanlicun/article/details/79127166
```

注意修改tab的长度：不同操作系统不同



然后修改注意修改里面给出的Makefile

```shell
#this is a make file
main.out: max.o min.o main.c
    gcc max.o min.o main.c -o main.out #tab间隔

max.o: max.c
    gcc -c max.c -o max.o

min.o: min.c
    gcc -c min.c -o min.o

```



然后可以了



## 实操记录

```shell
os6905@Huanan1:~/lab2$ ls
os6905@Huanan1:~/lab2$ vi max.c
os6905@Huanan1:~/lab2$ vi min.c
os6905@Huanan1:~/lab2$ vi max.h

os6905@Huanan1:~/lab2$ vi max.h
os6905@Huanan1:~/lab2$ vi min.h
os6905@Huanan1:~/lab2$ vi main.c
os6905@Huanan1:~/lab2$ gcc -c max.c -o max.o
os6905@Huanan1:~/lab2$ gcc -c min.c -o min.o
os6905@Huanan1:~/lab2$ gcc max.o min.o  main.c -o main
os6905@Huanan1:~/lab2$ ./main
the max value is 5
the min value is 3
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ make
Makefile:3: *** missing separator.  Stop.
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ make
Makefile:3: *** missing separator.  Stop.
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ rm -f Makefile
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ make
Makefile:3: *** missing separator.  Stop.
os6905@Huanan1:~/lab2$ vim Makefile
os6905@Huanan1:~/lab2$ ls -al
total 60
drwxr-xr-x 2 os6905 os6905  4096 Jun  3 09:37 .
drwxr-xr-x 4 os6905 os6905  4096 Jun  3 09:37 ..
-rwxr-xr-x 1 os6905 os6905 16728 Jun  3 09:27 main
-rw-r--r-- 1 os6905 os6905   285 Jun  3 09:26 main.c
-rw-r--r-- 1 os6905 os6905   181 Jun  3 09:33 Makefile
-rw-r--r-- 1 os6905 os6905   138 Jun  3 09:25 max.c
-rw-r--r-- 1 os6905 os6905    24 Jun  3 09:26 max.h
-rw-r--r-- 1 os6905 os6905  1240 Jun  3 09:26 max.o
-rw-r--r-- 1 os6905 os6905   119 Jun  3 09:25 min.c
-rw-r--r-- 1 os6905 os6905    22 Jun  3 09:26 min.h
-rw-r--r-- 1 os6905 os6905  1240 Jun  3 09:26 min.o
os6905@Huanan1:~$ mkdir lab2
os6905@Huanan1:~$ cd lab2
os6905@Huanan1:~/lab2$ ls
os6905@Huanan1:~/lab2$ vi max.c
os6905@Huanan1:~/lab2$ vi min.c
os6905@Huanan1:~/lab2$ vi max.h
os6905@Huanan1:~/lab2$ vi min.hwq
os6905@Huanan1:~/lab2$ vi min.h
os6905@Huanan1:~/lab2$ rm min.hwq
os6905@Huanan1:~/lab2$ vi main.c
os6905@Huanan1:~/lab2$ vi main.c
os6905@Huanan1:~/lab2$ gcc -c max.c -o max.o
os6905@Huanan1:~/lab2$ gcc -c min.c -o min.o
os6905@Huanan1:~/lab2$ gcc max.o min.o  main.c -o main
os6905@Huanan1:~/lab2$ ./main
the max value is 5
the min value is 3
os6905@Huanan1:~/lab2$ ./main
the max value is 5
the min value is 3
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ make
make: *** No rule to make target '-o', needed by 'main.out'.  Stop.
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ make
max.o min.o main.c -o main.out
make: max.o: No such file or directory
make: *** [Makefile:3: main.out] Error 127
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ cat Makefile
#this is  make file
main.out:
        max.o min.o main.c -o main.out
        gcc max.o min.o main.c #tab间隔
max.o:max.c
        gcc -c max.c  -o max.o
min.o:min.c
        gcc -c min.c -o min.c
os6905@Huanan1:~/lab2$ rm -f Makefile
os6905@Huanan1:~/lab2$ vi Makefile
os6905@Huanan1:~/lab2$ make
gcc max.o min.o main.c -o main.out #tab间隔
os6905@Huanan1:~/lab2$ make
make: 'main.out' is up to date.
os6905@Huanan1:~/lab2$ ls
main  main.c  main.out  Makefile  max.c  max.h  max.o  min.c  min.h  min.o
os6905@Huanan1:~/lab2$ main.out
bash: main.out: command not found
os6905@Huanan1:~/lab2$ ./main.out
the max value is 5
the min value is 3
os6905@Huanan1:~/lab2$ cat Makefile
#this is a make file
main.out: max.o min.o main.c
        gcc max.o min.o main.c -o main.out #tab间隔

max.o: max.c
        gcc -c max.c -o max.o

min.o: min.c
        gcc -c min.c -o min.o

os6905@Huanan1:~/lab2$ 
```



## inTEST

```shell
os6905@Huanan1:~/lab1$ cd test
os6905@Huanan1:~/lab1/test$ vim a.c
os6905@Huanan1:~/lab1/test$ vim b.c
os6905@Huanan1:~/lab1/test$ cat a.c
#include<stdio.h>

int main(void)
{
        printf("hello world a .../n");

        return 0;
}
os6905@Huanan1:~/lab1/test$ vim b.c
os6905@Huanan1:~/lab1/test$ ls
a.c  b.c
os6905@Huanan1:~/lab1/test$ vim Makefile
os6905@Huanan1:~/lab1/test$ make
gcc -c a.c -o a.o
gcc a.o -o a
gcc -c b.c -o b.o
gcc b.o -o b
os6905@Huanan1:~/lab1/test$ cat Makefile
#一条规则
all: a b
a:a.o
        gcc $< -o $@

b:b.o
        gcc $< -o $@
#模式规则
%.o:%.c
        gcc -c $< -o $@
.PHONY:clean
clean:
        -rm --f a b *.o
os6905@Huanan1:~/lab1/test$ ls
a  a.c  a.o  b  b.c  b.o  Makefile
os6905@Huanan1:~/lab1/test$ vim Makefile
os6905@Huanan1:~/lab1/test$ make
Makefile:40: warning: overriding recipe for target 'clean'
Makefile:13: warning: ignoring old recipe for target 'clean'
echo 

echo 

echo rm -f
rm -f
os6905@Huanan1:~/lab1/test$ cat Makefile
#一条规则
all: a b
a:a.o
        gcc $< -o $@

b:b.o
        gcc $< -o $@
#模式规则
%.o:%.c
        gcc -c $< -o $@
.PHONY:clean
clean:
        -rm --f a b *.o




#获取src目录中所有的.c文件
SRC=$(wildcard ./src/*.c)
#替换成目标文件  obj/*.o
OBJS=$(patsubst ./src/%.c, ./obj/%.o, $(SRC))

#变量定义
CC=gcc
INC=./inc
CFLAGS=-c 
TARGET=./bin/test

$(TARGET):$(OBJS)
        $(CC) $^ -o $@
        @#mv $(TARGET) bin/

#将对应的.c生成对应的.o文件
./obj/%.o:./src/%.c
        @#gcc -c -I./inc $< -o $@
        $(CC) $(CFLAGS) -I$(INC) $< -o $@
#伪目标
.PHONY:clean all
clean:
        $(RM) $(OBJS) $(TARGET)

#辅助调试c
all:
        echo $(SRC)
        echo $(OBJS)
        echo $(RM)
os6905@Huanan1:~/lab1/test$ 
```

